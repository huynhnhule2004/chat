#!/bin/bash

echo "üéØ Backend Deployment Summary"
echo "========================================="
echo "‚úÖ Server: 146.190.194.170"
echo "‚úÖ MongoDB: System MongoDB running on port 27017"
echo "‚úÖ Docker: Version 28.5.0 with Compose v2.40.0"
echo "‚úÖ Package: backend-deploy-fixed.tar.gz deployed"
echo "‚úÖ Config: Using host network mode for MongoDB access"
echo "‚úÖ Container: chat_backend_api built and started"
echo ""
echo "üìä Deployment Status: SUCCESS"
echo "üê≥ Container Status: Running (healthy)"
echo "üóÑÔ∏è  Database: Connected to system MongoDB"
echo "üîß Environment: Production"
echo "üåê Port: 5000"
echo ""
echo "üåç Access URLs:"
echo "   API Health: http://146.190.194.170:5000/health"
echo "   Swagger UI: http://146.190.194.170:5000/api/docs" 
echo "   API Base:   http://146.190.194.170:5000/api"
echo ""
echo "üõ†Ô∏è  Management Commands (on server):"
echo "   cd /root/trung_dev"
echo "   docker compose ps              # Check status"
echo "   docker compose logs backend    # View logs"
echo "   docker compose restart backend # Restart service"
echo "   docker compose down            # Stop service"
echo ""
echo "‚ú® Deployment completed successfully!"
echo "üéâ Backend API with Swagger documentation is now running"

# Test connection if possible
echo ""
echo "üîç Testing connection..."
if curl -s -m 5 http://146.190.194.170:5000/health > /dev/null 2>&1; then
    echo "‚úÖ API is accessible externally"
else 
    echo "‚ö†Ô∏è  External access test failed (may be firewall/network)"
    echo "   Try: ssh root@146.190.194.170 'curl http://localhost:5000/health'"
fi
